2025-06-03 14:00:07,713 [INFO] Created logger with run_dir: /home3/s5238366/plant-disease-classification/src/training/../../logs/resnet50/resnet50_12
2025-06-03 14:00:07,713 [INFO] Starting training run.
2025-06-03 14:00:07,719 [INFO] Copied main script to /home3/s5238366/plant-disease-classification/src/training/../../logs/resnet50/resnet50_12/train_resnet50.py
2025-06-03 14:02:37,929 [INFO] Epoch 01 | Train Loss: 0.5514 | Val Loss: 0.2230
2025-06-03 14:05:04,531 [INFO] Epoch 02 | Train Loss: 0.2707 | Val Loss: 0.1777
2025-06-03 14:07:32,059 [INFO] Epoch 03 | Train Loss: 0.2333 | Val Loss: 0.1542
2025-06-03 14:10:02,411 [INFO] Epoch 04 | Train Loss: 0.2129 | Val Loss: 0.1487
2025-06-03 14:10:02,412 [INFO] Unfroze layer4 at epoch 5 with lr=0.0001
2025-06-03 14:12:37,721 [INFO] Epoch 05 | Train Loss: 0.1376 | Val Loss: 0.0628
2025-06-03 14:15:12,009 [INFO] Epoch 06 | Train Loss: 0.0935 | Val Loss: 0.0368
2025-06-03 14:17:47,013 [INFO] Epoch 07 | Train Loss: 0.0738 | Val Loss: 0.0329
2025-06-03 14:20:24,557 [INFO] Epoch 08 | Train Loss: 0.0597 | Val Loss: 0.0267
2025-06-03 14:23:00,011 [INFO] Epoch 09 | Train Loss: 0.0552 | Val Loss: 0.0257
2025-06-03 14:23:00,013 [INFO] Unfroze layer3 at epoch 10 with lr=1e-05
2025-06-03 14:25:41,293 [INFO] Epoch 10 | Train Loss: 0.0498 | Val Loss: 0.0232
2025-06-03 14:28:22,729 [INFO] Epoch 11 | Train Loss: 0.0467 | Val Loss: 0.0253
2025-06-03 14:31:10,009 [INFO] Epoch 12 | Train Loss: 0.0421 | Val Loss: 0.0252
2025-06-03 14:33:53,449 [INFO] Epoch 13 | Train Loss: 0.0396 | Val Loss: 0.0220
2025-06-03 14:36:38,839 [INFO] Epoch 14 | Train Loss: 0.0384 | Val Loss: 0.0177
2025-06-03 14:39:21,180 [INFO] Epoch 15 | Train Loss: 0.0368 | Val Loss: 0.0205
2025-06-03 14:42:02,154 [INFO] Epoch 16 | Train Loss: 0.0369 | Val Loss: 0.0186
2025-06-03 14:44:44,708 [INFO] Epoch 17 | Train Loss: 0.0365 | Val Loss: 0.0181
2025-06-03 14:47:31,706 [INFO] Epoch 18 | Train Loss: 0.0351 | Val Loss: 0.0175
2025-06-03 14:50:17,365 [INFO] Epoch 19 | Train Loss: 0.0357 | Val Loss: 0.0178
2025-06-03 14:53:02,441 [INFO] Epoch 20 | Train Loss: 0.0339 | Val Loss: 0.0180
2025-06-03 14:55:43,499 [INFO] Epoch 21 | Train Loss: 0.0350 | Val Loss: 0.0178
2025-06-03 14:58:29,131 [INFO] Epoch 22 | Train Loss: 0.0340 | Val Loss: 0.0174
2025-06-03 15:01:11,853 [INFO] Epoch 23 | Train Loss: 0.0348 | Val Loss: 0.0178
2025-06-03 15:03:52,848 [INFO] Epoch 24 | Train Loss: 0.0336 | Val Loss: 0.0184
2025-06-03 15:06:36,648 [INFO] Epoch 25 | Train Loss: 0.0339 | Val Loss: 0.0197
2025-06-03 15:09:18,140 [INFO] Epoch 26 | Train Loss: 0.0342 | Val Loss: 0.0181
2025-06-03 15:12:05,393 [INFO] Epoch 27 | Train Loss: 0.0347 | Val Loss: 0.0187
2025-06-03 15:14:47,585 [INFO] Epoch 28 | Train Loss: 0.0336 | Val Loss: 0.0189
2025-06-03 15:17:33,072 [INFO] Epoch 29 | Train Loss: 0.0348 | Val Loss: 0.0172
2025-06-03 15:20:16,779 [INFO] Epoch 30 | Train Loss: 0.0339 | Val Loss: 0.0183
2025-06-03 15:22:58,886 [INFO] Epoch 31 | Train Loss: 0.0344 | Val Loss: 0.0180
2025-06-03 15:25:40,982 [INFO] Epoch 32 | Train Loss: 0.0344 | Val Loss: 0.0189
2025-06-03 15:28:20,210 [INFO] Epoch 33 | Train Loss: 0.0319 | Val Loss: 0.0181
2025-06-03 15:31:03,861 [INFO] Epoch 34 | Train Loss: 0.0332 | Val Loss: 0.0177
2025-06-03 15:33:45,096 [INFO] Epoch 35 | Train Loss: 0.0337 | Val Loss: 0.0184
2025-06-03 15:36:27,360 [INFO] Epoch 36 | Train Loss: 0.0339 | Val Loss: 0.0177
2025-06-03 15:39:10,431 [INFO] Epoch 37 | Train Loss: 0.0337 | Val Loss: 0.0174
2025-06-03 15:41:47,836 [INFO] Epoch 38 | Train Loss: 0.0328 | Val Loss: 0.0176
2025-06-03 15:44:27,578 [INFO] Epoch 39 | Train Loss: 0.0344 | Val Loss: 0.0175
2025-06-03 15:44:27,578 [INFO] Early stopping at epoch 39 (no improvement for 10 epochs).
2025-06-03 15:44:27,880 [INFO] Model weights saved to /home3/s5238366/plant-disease-classification/src/training/../../logs/resnet50/resnet50_12/resnet50.pth
2025-06-03 15:44:28,101 [INFO] Loss curve saved to /home3/s5238366/plant-disease-classification/src/training/../../logs/resnet50/resnet50_12/loss_curve.png
2025-06-03 15:44:53,644 [INFO] Test Confusion Matrix:
[[ 94   0   0 ...   0   0   0]
 [  0  93   0 ...   0   0   0]
 [  0   0  41 ...   0   0   0]
 ...
 [  0   0   0 ... 784   0   0]
 [  0   0   0 ...   0  56   0]
 [  0   0   0 ...   0   0 239]]
2025-06-03 15:44:53,645 [INFO] Test Classification Report:
                                                    precision    recall  f1-score   support

                                Apple___Apple_scab     0.9895    1.0000    0.9947        94
                                 Apple___Black_rot     0.9894    1.0000    0.9947        93
                          Apple___Cedar_apple_rust     1.0000    1.0000    1.0000        41
                                   Apple___healthy     0.9960    1.0000    0.9980       247
                               Blueberry___healthy     1.0000    0.9911    0.9955       225
          Cherry_(including_sour)___Powdery_mildew     1.0000    1.0000    1.0000       158
                 Cherry_(including_sour)___healthy     0.9922    0.9922    0.9922       128
Corn_(maize)___Cercospora_leaf_spot Gray_leaf_spot     0.9103    0.9221    0.9161        77
                       Corn_(maize)___Common_rust_     1.0000    0.9888    0.9944       179
               Corn_(maize)___Northern_Leaf_Blight     0.9463    0.9527    0.9495       148
                            Corn_(maize)___healthy     1.0000    1.0000    1.0000       174
                                 Grape___Black_rot     0.9944    1.0000    0.9972       177
                      Grape___Esca_(Black_Measles)     1.0000    0.9952    0.9976       207
        Grape___Leaf_blight_(Isariopsis_Leaf_Spot)     1.0000    1.0000    1.0000       161
                                   Grape___healthy     1.0000    1.0000    1.0000        63
          Orange___Haunglongbing_(Citrus_greening)     1.0000    1.0000    1.0000       826
                            Peach___Bacterial_spot     0.9942    0.9942    0.9942       345
                                   Peach___healthy     0.9818    1.0000    0.9908        54
                     Pepper,_bell___Bacterial_spot     0.9868    1.0000    0.9934       150
                            Pepper,_bell___healthy     0.9865    0.9910    0.9888       222
                             Potato___Early_blight     1.0000    1.0000    1.0000       150
                              Potato___Late_blight     0.9931    0.9533    0.9728       150
                                  Potato___healthy     1.0000    1.0000    1.0000        23
                               Raspberry___healthy     1.0000    1.0000    1.0000        56
                                 Soybean___healthy     1.0000    0.9961    0.9980       764
                           Squash___Powdery_mildew     1.0000    0.9964    0.9982       275
                          Strawberry___Leaf_scorch     1.0000    0.9940    0.9970       166
                              Strawberry___healthy     1.0000    1.0000    1.0000        68
                           Tomato___Bacterial_spot     0.9606    0.9937    0.9769       319
                             Tomato___Early_blight     0.9859    0.9333    0.9589       150
                              Tomato___Late_blight     0.9690    0.9825    0.9757       286
                                Tomato___Leaf_Mold     1.0000    1.0000    1.0000       143
                       Tomato___Septoria_leaf_spot     0.9885    0.9737    0.9811       266
     Tomato___Spider_mites Two-spotted_spider_mite     0.9705    0.9163    0.9426       251
                              Tomato___Target_Spot     0.9009    0.9479    0.9238       211
            Tomato___Tomato_Yellow_Leaf_Curl_Virus     1.0000    0.9751    0.9874       804
                      Tomato___Tomato_mosaic_virus     0.9825    1.0000    0.9912        56
                                  Tomato___healthy     0.9053    1.0000    0.9503       239

                                          accuracy                         0.9864      8146
                                         macro avg     0.9848    0.9866    0.9855      8146
                                      weighted avg     0.9868    0.9864    0.9864      8146

2025-06-03 15:44:53,675 [INFO] Per-class metrics saved to /home3/s5238366/plant-disease-classification/src/training/../../logs/resnet50/resnet50_12/metrics.csv
